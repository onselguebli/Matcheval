<!-- src/app/checkedlist/recruiter-checked-list/recruiter-checked-list.component.html -->
<div class="panel">
  <div class="panel__header">
    <div class="title">
      <span class="emoji">🗂️</span>
      <h2>CV cochés (recruteur)</h2>
    </div>

    <div class="toolbar">
      <input class="input" type="search" [(ngModel)]="query" placeholder="Rechercher (offre, candidat, email)..." />
      <select class="select" (change)="onSortChange($event)">
        <option value="date" selected>Trier par date</option>
        <option value="score">Trier par score</option>
      </select>
      <button class="btn" (click)="load()">⟳ Actualiser</button>
    </div>
  </div>

  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <span>Chargement...</span>
  </div>
  <div *ngIf="error" class="alert alert--error">{{ error }}</div>

  <div class="tablewrap" *ngIf="!loading && filtered.length > 0">
    <table class="table">
      <thead>
        <tr>
          <th>Offre</th>
          <th>Candidat</th>
          <th>Email</th>
          <th>Score</th>
          <th>Créé le</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let it of filtered">
          <td class="mono">#{{ it.offreId || '-' }} — {{ it.offreTitre || '-' }}</td>
          <td>{{ (it.candidatPrenom || '') + ' ' + (it.candidatNom || '') }}</td>
          <td class="mono">{{ it.candidatEmail || '-' }}</td>
          <td><span [class]="scoreClass(it.scoreOverall)">{{ ((it.scoreOverall ?? 0) * 100) | number:'1.0-0' }}%</span></td>
          <td>{{ it.createdAt | date:'dd/MM/yyyy HH:mm' }}</td>
          <td class="actions">
            <button class="btn btn--danger" (click)="delete(it.id)" title="Supprimer">🗑️</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && filtered.length === 0" class="empty">
    <span class="emoji">🔍</span>
    <p>Aucun élément trouvé.</p>
  </div>
</div>
